subroutine errfun(Ngrid,r,n,mu,rsfunC)
implicit none
real(8), PARAMETER :: Pi = 3.1415926535897932384d0
integer, intent(in) :: Ngrid,n
real(8), intent(in) :: r(Ngrid),mu
complex(8),intent(out) :: rsfunC(n,2) 

real(8) ::AA1(n),AA2(n),BB1(n),BB2(n)
complex(8) :: rez(Ngrid)
real(8) :: rmax, temp(Ngrid)
real(8) :: a1,a2
integer :: i,ir,k


write(*,*)n,mu
if (n.eq.9)then
AA1=(/1.1793556928516621d01*0.5d0,-3.3997542606327369d00,-3.1999804759139012d00,&
1.2431945263044286d00,-1.5923036135878112d-02,-2.6330008531846357d-02,&
2.0107048788385695d-03,5.9871920957920612d-06,-1.9014193114960453d-06/)

AA2=(/0.0000000000000000d00,8.5884213008725414d00,-3.1024703144846724d00,&
-5.0090970998006024d-01,2.5412899494655228d-01,-1.5691616874704249d-02,&
-1.2226946313412218d-03,1.2240497422195631d-04,-2.1757399102663054d-06/)

BB1=(/4.5539394422559072d00,4.5539394422559072d00,4.5539394422559072d00,&
4.5539394422559072d00,4.5539394422559072d00,4.5539394422559072d00,&
4.5539394422559072d00,4.5539394422559072d00,4.5539394422559072d00/)

BB2=(/0.0000000000000000d00,9.4528885879869029d-01,1.8906858418787154d00,&
2.8358504737190153d00,3.7810807937266149d00,4.7286024942709624d00,&
5.6705170300130971d00,6.6184139539428530d00,7.7009425117754589d00/)
elseif (n.eq.8)then

AA1=(/1.2860987030345912d01*0.5d0,-4.9051058740247786d00,-1.9357963384430639d00,1.0117925923974511d00,&
        -9.9013582507628040d-02,-3.3813615287899379d-03,1.0330516726180475d-03,-2.2002738770173973d-05/)

AA2=(/0.0000000000000000d00,8.4204906883706165d00,-3.7444370420962709d00,1.5201429359841603d-01,&
        9.5997444318657268d-02,-1.1743959149248155d-02,1.5238534910174336d-04,5.8451000772024675d-06/)

BB1=(/4.5617402703990644d00,4.5617402703990644d00,4.5617402703990644d00,4.5617402703990644d00,&
        4.5617402703990644d00,4.5617402703990644d00,4.5617402703990644d00,4.5617402703990644d00/)

BB2=(/0.0000000000000000d00,1.0160216352396843d00,2.0413334512076715d00,3.0805139945811777d00,&
        4.1164481828964572d00,5.0646792984847675d00,5.9785623723578114d00,7.2027553450037622d00/)
rmax=5.3d0

elseif (n.eq.7)then
AA1=(/1.04388861772302022d01*0.5d0,-4.15230200875813171d00,-1.09637578338378838d00,&
5.85340334546933239d-01,-5.72214605455547975d-02,1.11445947001131431d-03,&
1.37005560127951071d-06/)

AA2=(/0.00000000000000000d00,6.36698813144878617d00,-2.73158403646281123d00,&
1.69412383167246605d-01,3.58625769268040781d-02,-3.56355734717054293d-03,&
7.06617335882476496d-05/)

BB1=(/4.42897206653721742d00,4.42897206653721742d00,4.42897206653721742d00,&
4.42897206653721742d00,4.42897206653721742d00,4.42897206653721742d00,&
4.42897206653721742d00/)

BB2=(/0.00000000000000000d00,1.07811959900154442d00,2.16055514404308591d00,&
3.25051246017242557d00,4.35355433640683831d00,5.50798572653768748d00,&
6.80680166786776208d00/)

elseif (n.eq.6)then

AA1=(/1.16801622501244324d01*0.5d0,-5.58814846386175379d00,4.00500965163793701d-02,&
2.27420591587985083d-01,-1.96862899952504854d-02,2.82940691484453110d-04/)

AA2=(/0.00000000000000000d00,5.91087741873710648d00,-2.71301646794361151d00,&
3.41139126788647828d-01,-1.37953981033003721d-02,2.25664278898155479d-04/)

BB1=(/4.44903651057751848d00,4.44903651057751848d00,4.44903651057751848d00,&
4.44903651057751848d00,4.44903651057751848d00,4.44903651057751848d00/)

BB2=(/0.00000000000000000d00,1.16136522308686563d00,2.34291495991631837d00,&
3.57030720633363519d00,4.88590055700419601d00,6.37901581267626661d00/)

elseif (n.eq.5)then
AA1=(/5.88649164984019890d00*0.5d0,-2.42999364511904048d00,-6.52318163977785026d-02,&
5.35112928141888433d-02,-1.53165601674370706d-03/)

AA2=(/0.00000000000000000d00,2.89879784656921213d00,-9.81481713958860635d-01,&
7.58072684236921479d-02,-1.61854017761636944d-03/)

BB1=(/4.03651233059081704d0,4.03651233059081704d0,4.03651233059081704d0,&
4.03651233059081704d0,4.03651233059081704d0/)

BB2=(/0.00000000000000000d0,1.27567126568311573d0,2.58394634761278397d0,&
3.97319627725742608d0,5.52839978282953215d0/)

elseif (n.eq.4)then

AA1=(/3.34075293484632052d00*0.5d0,-1.14940001089277311d00,-2.63828385336642122d-02,&
5.40643159457097119d-03/)


AA2=(/0.00000000000000000d00,1.50422252025890724d00,-3.29745255232857859d-01,&
1.22265802959771012d-02/)


BB1=(/3.62435558273901570d0,3.62435558273901570d0,3.62435558273901570d0,&
3.62435558273901570d0/)

BB2=(/0.00000000000000000d0,1.43494484832715830d0,2.93170108446797961d0,&
4.59735152907431743d0/)

endif



rmax=rmax/mu
   do i = 1,n
      rsfunC(i,1)=cmplx(AA1(i),AA2(i),8)
      rsfunC(i,2)=cmplx(BB1(i),BB2(i),8)
   end do

!write(*,*)" A"
!do i=1, n
!write(*,*)rsfunC(i,1)
!enddo
!write(*,*)" B"
!do i=1, n
!write(*,*)rsfunC(i,2)
!enddo


 rsfunC(:,2)=rsfunC(:,2)*mu




   rez=cmplx(0d0,0d0,8)*r
 !  rez=rez+rsfunC(1,1)*exp(-rsfunC(1,2)*r)
   do i=1, n
     rez=rez+rsfunC(i,1)*exp(-rsfunC(i,2)*r)
     rez=rez+conjg(rsfunC(i,1))*exp(-conjg(rsfunC(i,2))*r)
   enddo
   open(11,file='erfc_test.dat',status='replace')
   write(11,*)"erfc RE(rez) Im(rez) erfc-RE(rez) mu=",mu," rmax=",rmax
   do i=1, Ngrid
     write(11,*)r(i), erfc(mu*r(i)), realpart(rez(i)), imagpart(rez(i)),erfc(mu*r(i))-realpart(rez(i))
   enddo
   close(11)

end subroutine


subroutine wigner3j(j1,j2,j3,rez)
implicit none
real(8), PARAMETER :: Pi = 3.1415926535897932384d0
integer, intent(in) :: j1,j2,j3
real(8), intent(out) :: rez

integer ::n,i, j1a(23),j2a(23),j3a(23)
real(8) :: wa(23)
n=23

j1a=(/0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3/)
j2a=(/0, 1, 2, 3, 0, 1, 1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 0, 1, 2, 2, 3, 3/)
j3a=(/0, 1, 2, 3, 1, 0, 2, 1, 3, 2, 2, 1, 3, 0, 2, 1, 3, 3, 2, 1, 3, 0, 2/)
wa=(/1.0d0, -0.5773502691896258d0, 0.447213595499958d0, -0.3779644730092272d0, -0.5773502691896258d0,&
        -0.5773502691896258d0, 0.36514837167011077d0, 0.36514837167011077d0, -0.29277002188455997d0,&
        -0.29277002188455997d0, 0.4472135954999579d0, 0.3651483716701108d0, -0.29277002188456d0,&
        0.4472135954999579d0, -0.23904572186687875d0, -0.29277002188456d0, 0.1951800145897066d0,&
        -0.3779644730092272d0, -0.29277002188455997d0, -0.29277002188455997d0, 0.19518001458970663d0,&
        -0.3779644730092272d0, 0.19518001458970663d0/)

rez=0d0
do i=1,n
  if ((j1a(i).eq.j1).and.(j2a(i).eq.j2).and.(j3a(i).eq.j3)) then
          rez=wa(i)
          exit
  endif
enddo

end subroutine

